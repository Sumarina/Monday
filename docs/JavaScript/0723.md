# 关于 this

当 JavaScript 执行到一段可执行代码时，会创建一个可执行上下文。执行上下文可以理解为当前代码的执行环境。
执行上下文的周期可以分为两个阶段。

1. 创建阶段

   在这个阶段，可执行上下文会创建变量对象、建立作用域链以及**确定 this 指向问题**。

1. 代码执行阶段

   创建完成后，就开始执行代码，完成变量赋值、函数引用以及执行其他代码。

## 如何判断 this 的指向

**this 对象是基于当前运行环境执行时所绑定的。**

1. 在全局函数(也就是全局作用域)中，this 等于 window。
1. 当函数被作为某个对象的方法调用时，this 等于那个对象。(注意：匿名函数具的执行具有全局性，因此 this 是指向 window)。
1. 使用 new 的方式创建的实例，this 指向这个实例(新创建的对象)。

使用 new 操作符创建的实例，经历 4 个步骤。

1. 创建一个新对象
1. 将构造函数的作用域赋给新对象(所以 this 是指向这个新对象)。
1. 执行构造函数中的代码，为这个新对象添加属性
1. 返回新对象

```js
function Person(name, age) {
  this.name = name;
  this.age = age;
}
// 在这里可以把Person当作一个构造函数
// 所以在new Person的时候就相当于把它的作用域指向了p
// 所以Person中的this是指向p的
const p = new Person();
```

## 如何修改 this 的指向

1. call
1. apply
1. bind

## 关于箭头函数的 this
