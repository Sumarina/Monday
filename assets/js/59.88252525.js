(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{414:function(t,s,a){"use strict";a.r(s);var e=a(43),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"vue-内部运行机制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue-内部运行机制"}},[t._v("#")]),t._v(" vue 内部运行机制")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  router"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("render")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("h")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("h")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("App"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("$mount")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#app'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("使用"),a("code",[t._v("new")]),t._v("的方式，获取到一个"),a("code",[t._v("Vue")]),t._v("的实例。")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("使用 new 的方式创建实例的过程")]),t._v(" "),a("ol",[a("li",[t._v("创建一个新对象")]),t._v(" "),a("li",[t._v("新对象的"),a("code",[t._v("__proto__")]),t._v("指向函数的原型")]),t._v(" "),a("li",[t._v("将构造函数的作用域赋值给新对象，执行构造函数中的代码，为这个对象添加属性。")]),t._v(" "),a("li",[t._v("如果函数没有返回其他对象，则返回这个新对象。")])])]),t._v(" "),a("p",[t._v("在"),a("code",[t._v("init")]),t._v("函数中调用一堆初始化操作的函数之后，再调用"),a("code",[t._v("$mount")]),t._v("挂载组件，如果不存在"),a("code",[t._v("render function")]),t._v("但是存在"),a("code",[t._v("template")]),t._v("，需要进行"),a("code",[t._v("编译")]),t._v("步骤。")]),t._v(" "),a("p",[a("code",[t._v("compile")]),t._v("分为"),a("code",[t._v("parse")]),t._v("、"),a("code",[t._v("optimize")]),t._v("和"),a("code",[t._v("generate")]),t._v("三个阶段。")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("parse")]),t._v("阶段：解析 template（指令、css、style 等），生成 AST。")]),t._v(" "),a("li",[a("code",[t._v("optimize")]),t._v("阶段：标记静态节点，在 patch 过程中，diff 算法会跳过静态节点，减少了比较过程，优化了 patch 性能。")]),t._v(" "),a("li",[a("code",[t._v("generate")]),t._v("阶段：将 AST 转化为 render function 字符串的过程。")])]),t._v(" "),a("p",[t._v("经历过三个阶段后，会拿到渲染 VNode 所需要的 render function。")]),t._v(" "),a("p",[t._v("未完待续")])])}),[],!1,null,null,null);s.default=n.exports}}]);